---
layout: default
title: 6. JOIN, FOR ALL ENTRIES IN구문 정리
parent: abapstudy
nav_order: 6
---
# 6. JOIN, FOR ALL ENTRIES IN구문 정리

```abap
SELECT ZTTEST_215_HR~ZCODE ZTTEST_215_HR~ZNAME ZTTEST_215_UNI~ZMAJOR
  INTO CORRESPONDING FIELDS OF TABLE GT_DATA7
  FROM ZTTEST_215_HR
  INNER JOIN ZTTEST_215_UNI
  ON ZTTEST_215_HR~ZCODE = ZTTEST_215_UNI~ZCODE.
  
SELECT HR~ZCODE HR~ZNAME UNI~ZMAJOR
  INTO CORRESPONDING FIELDS OF TABLE GT_DATA7
  FROM ZTTEST_215_HR AS HR
  JOIN ZTTEST_215_UNI AS UNI
  ON HR~ZCODE = UNI~ZCODE.
  
*CL_DEMO_OUTPUT=>DISPLAY( GT_DATA7 ).

DATA : BEGIN OF GS_DATA8,
        ZCODE TYPE ZTTEST_215_HR-ZCODE,
        ZNAME TYPE ZTTEST_215_HR_ZNAME,
        ZMAJOR TYPE ZTTEST_215_UNI_ZMAJOR,
        ZTOEIC TYPE ZTTEST_215_COM-ZTOEIC,
       END OF GS_DATA8.
DATA : GT_DATA8 LIKE TABLE OF GS_DATA8.

SELECT HR~ZCODE HR~ZNAME UNI~ZMAJOR COM~ZTOEIC
  INTO CORRESPONDING FIELDS OF TABLE GT_DATA8
  FROM ZTTEST_215_HR AS HR
  JOIN ZTTEST_215_UNI AS UNI
  ON HR~ZCODE = UNI~ZCODE
  JOIN ZTTEST_215_COM AS COM
  ON HR~ZCODE = COM~ZCODE.
  
CL_DEMO_OUTPUT=>DISPLAY( GT_DATA8 ).
```

```abap
DATA : BEGIN OF GS_DATA7,
        ZCODE LIKE ZTTEST_215_HR-ZCODE,
        ZNAME LIKE ZTTEST_215_HR-ZNAME,
        ZMAJOR LIKE ZTTEST_215_UNI-ZMAJOR,
      END OF GS_DATA7.
DATA : GT_DATA7 LIKE TABLE OF GS_DATA7.

DATA : GS_HR LIKE GS_DATA7,
       GT_HR LIKE TABLE OF GS_DATA7.

DATA : BEGIN OF GS_UNI,
        ZCODE TYPE ZTTEST_215_HR-ZCODE,
        ZMAJOR TYPE ZTTEST_215_UNI-ZMAJOR,
       END OF GS_UNI.
DATA : GT_UNI LIKE TABLE OF GS_UNI.

SELECT ZCODE ZNAME
  INTO CORRESPONDING FIELDS OF TABLE GT_HR
  FROM ZTTEST_215_HR.

SELECT ZCODE ZMAJOR
  INTO CORRESPONDING FIELDS OF TABLE GT_UNI
  FROM ZTTEST_215_UNI
  
SELECT HR~ZCODE HR~ZNAME UNI~ZMAJOR
  INTO CORRESPONDING FIELDS OF TABLE GT_DATA7
  FROM ZTTEST_215_HR AS HR
  LEFT OUTER JOIN ZTTEST_215_UNI AS UNI
  ON HR_ZCODE = UNI~ZCODE.
  
CL_DEMO_OUTPUT=>DISPLAY( GT_DATA7 ).
```

```abap
DATA : BEGIN OF GS_PROMOTION,
        ZGENDER LIKE ZTTEST_215_HR-ZGENDER,
        ZHOBBY LIKE ZTTEST_215_HR-ZHOBBY,
       END OF GS_PROMOTION.
DATA : GT_PROMOTION LIKE TABLE OF GS_PROMOTION.

GS_PROMOTION-ZGENDER = '남'.
GS_PROMOTION-ZHOBBY = '탁구'.
APPEND GS_PROMOTION TO GT_PROMOTION.

GS_PROMOTION-ZGENDER = '여'.
GS_PROMOTION-ZHOBBY = '독서'.
APPEND GS_PROMOTION TO GT_PROMOTION.

"조건이 두가지여서 RANGES를 쓸 수가 없다.
"한개씩 남 OR 여 OR 탁구 OR 독서가 되어버려서 불가능.

DATA : GT_DATA10 LIKE ZTTEST_215_HR OCCRS 0.

SELECT *
  INTO TABLE GT_DATA10
  FROM ZTTEST_215_HR
  FOR ALL ENTRIES IN GT_PROMOTION
  WHERE ZGENDER = GT_PROMOTION-ZGENDER
  AND ZHOBBY = GT_PROMOTION-ZHOBBY.
  
CL_DEMO_OUTPUT=>DISPLAY( GT_DATA10 ).
```

## FOR ALL ENTRIES IN

FOR ALL ENTRIES 구문은 인터널 테이블의 서브 쿼리와 유사함. WHERE구문의 조건은 인터널 테이블에 존재하는 필드만 필드만 가능.

## 주의점
1. 인터널 테이블의 컬럼과 비교 대상 테이블의 컬럼 타입이 같아야 함.
2. LIKE, BBETWEEN, IN과 같은 비교 구문은 사용 할 수 없음.
3. 인터널테이블의 중복된 값은 하나만 남음.(UNIQUE KEY 기준)
4. 인터널테이블이 NULL이면 모든 데이터를 읽음.
5. 인터널테이블의 수가 많으면 LOOP수가 증가하게 되므로 쿼리 속도가 느려짐

```abap
SELECT *
  INTO CORRESPONDING FIELDS OF TABLE GT_DATA
  FROM BKPF
  FOR ALL ENTRIES IN GT_BSEG
 WHERE BUKRS = GT_BSEG-BUKRS AND BELNR = GT_BSEG-BELNR
   AND GJAHR = GT_BSEG-GJAHR
   AND BUKRS = P_BUKRS
   AND GJAHR = P_GJAHR
   AND BLART IN S_BLART
   AND BELNR IN S_BELNR
   AND BLDAT IN S_BLDAT.
```
