---
layout: default
title: 7. 찾아 볼 PARAMETER, SCREEN 정리
parent: abapstudy
nav_order: 7
---
# 7. 찾아 볼 PARAMETER, SCREEN 정리

```abap
REPORT ZDSUWON02_1017 NO STANDARD PAGE HEADING.
"LINE-SIZE 1. 길이 설정
"A4는 132
"LINE-COUNT 20(3) (제목 포함 줄 갯수 지정. 총 20줄에 바닥글 3줄)
"MESSAGE-ID ZMSG (SE91) 공통적으로 쓰는 메세지 ZMSG 불러옴

"데이터 선언부, 조회조건 선언부 (프로그램 선언부 포함)
TABLES : ZDSUWONT02.

DATA : GV_VAR TYPE C LENGTH 10.

"1) 프로그램 선언부

WRITE : 'welcome'.

"2) 데이터 선언부
"3) 조회조건 선언부
"PARAMETERS, SELECT-OPTIONS
SELECTION-SCREEN BEGIN OF BLOCK BLOCK2 WITH FRAME TITLE TEXT-002.
  PARAMETERS : P_1 TYPE C LENGTH 1,
               P_2 TYPE ZDSUWONT02-ZEMPNO,
               P_3 TYPE ZDSUWONT02-ZEMPNO DEFAULT '20200001',
               P_4 TYPE P DECIMALS 2,
               P_5 TYPE C LENGTH 10 NO-DISPLAY,
               P_6 TYPE C LENGTH 10 OBLIGATORY,
               P_7 TYPE C MODIF ID ID1,
               P_8 TYPE DATUM MODIF ID ID1. "P_7과 P_8이 ID1로 묶임. 한번에 관리하기 위해.
  
  PARAMETERS : P_CHK1 AS CHECKBOX,
               P_CHK2 AS CHECKBOX DEFAULT 'X'.
  PARAMETERS : P_RADI1 RADIOBUTTON GROUP RADI DEFAULT 'X',
               p_RADI2 RADIOBUTTON GROUP RADI, "USER-COMMAND UCOM1,
               P_RADI3 RADIOBUTTON GROUP RADI.
  PARAMETERS : P_10 TYPE C LENGTH 10 VISIBLE LENTH 3 DEFAULT '12345678',
               P_11 LIKE ZDSUWONT02-ZDEPT VALUE CHECK,
               "외래키처럼 기능을 함. (테이블필드 사용시에만)
               "값을 잘 넣고있는지 확인 가능
               P_12 TYPE ZDSUWONT02-ZDEPT AS LISTBOX VISIBLE LENGTH 10.
SELECTION-SCREEN END OF BLOCK BLOCK2.
```

```abap
SELECTION-SCREEN BEGIN OF LINE.
  SELECTION-SVREEN COMMENT 1(10) TEXT-003 FOR FIELD P_100.
  PARAMETERS : P_100 AS CHECKBOX.
  SELECTION-SCREEN COMMENT 14(10) TEXT-004 FOR FIELD P_101.
  PARAMETERS : P_101 TYPE C LENGTH 10.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN SKIP 2. "1~9까지밖에 안됨.
SELECTION-SCREEN ULINE. "디폴트 길이
SELECTION-SCREEN ULINE /1(10).
SELECTION-SCREEN ULINE 20(10).

"SELECT-OPTIONS
"다중값 입력
"RANGE 변수와 같다 -> SIGN, OPTION, LOW, HIGH
"FOR로 변수 선언 가능 -> TABLES : ,DATA : 로 선언한 것들만 가능.
"값을 입력 안하면 전체 값을 가지고 옴
"WHERE조건 IN S_ZEMPNO.

SELECTION-SCREEN BEGIN OF BLOCK BLOCK1 WITH FRAME TITLE TEXT-001.
  SELECT-OPTIONS : S_0 FOR ZDSUWONT02-ZEMPNO,
                   S_1 FOR GV_VAR,
                   S_2 FOR ZDSUWONT02_ZEMPNO OBLIGATORY,
                   S_3 FOR ZDSUWONT02_ZEMPNO NO-DISPLAY,
                   S_4 FOR ZDSUWONT02_ZEMPNO NO-EXTENSION,
                   S_5 FOR ZDSUWONT02_ZEMPNO NO INTERVALS,
                   S_6 FOR ZDSUWONT02_ZEMPNO VISIBLE LENGTH 3,
                   S_7 FOR ZDSUWONT02_ZEMPNO MATCHCODE OBJECT ZSH_ZEMPNO02,
                   "SEARCH HELP. 사용 권고 안함 다른 방법을 이용.
SELECTION-SCREEN END OF BLOCK BLOCK1.
```

```abap
SELECTION-SCREEN FUNCTION KEY 1.

INITIALIZATION.
  SSCRFIELDS-FUNCTXT_01 = 'HI'.
  
AT SELECTION-SCREEN.
  IF SSCRFIELDS-UCOMM = 'PUSH1'.
    MESSAGE 'PUSHBUTTON1' TYPE 'I'.
  ELSEIF SSCRFIELDS-UCOMM = 'FC01'.
    MESSAGE '기능키1' TYPE 'I'.
  ENDIF.
  
START-OF-SELECTION.

SELECT *
  INTO CORRESPONDING FIELDS OF TABLE GT_DATA
  FROM ZDSUWONT02
  WHERE ZEMPNO = P_1.
  
END-OF-SELECTION.
LOOP AT GT_DATA INTO GS_DATA.
  WRITE : / GS_DATA-ZEMPNO,
            GS_DATA-ZEMPNM.
ENDLOOP.
```


```abap
IF SSCRFIELDS-UCOMM = 'PUSH1'.
  MESSAGE 'PUSHBUTTON1' TYPE 'I'.
ELSEIF SSCRFIELDS-UCOMM = 'PUSH2'.
  MESSAGE 'PUSHBUTTON2' TYPE 'I'.
ELSEIF SSCRFIELDS-UCOMM = 'FC01'.
  MESSAGE '기능키1' TYPE 'I'.
ELSEIF SSCRFIELDS-UCOMM = 'FC02'.
  MESSAGE E000 WITH '기능키2'. "WITH 뒤에 적는것은 ZMSG_02의 &변수에 값 넣는것
```

```abap
TOP-OF-PAGE.
  WRITE : 50 '페이지NO : ', SY-PAGNO.

END-OF-PAGE.
  WRITE : 50 '페이지NO : ', SY-PAGNO.
  ULINE.
```

```abap
REPORT ZDSUWON02_1017_2 LINE-COUNT 10(2) NO STANDARD PAGE HEADING.
```
LINE-COUNT로 페이지 카운트 해 놓고 페이지 설정 함

```abap
START-OF-SELECTION.

SET PF-STATUS 'STATUS1000'.
```

```abap
AT USER-COMMAND.
  CASE SY-UCOMM.
    WHEN 'LEAV'.
      LEAVE PROGRAM.
    WHEN 'BACK'.
      LEAVE TO SCREEN 0.
  ENDCASE.
```

### GET EXCEL UPLOAD FILE NAME

```abap
SELECTION-SCREEN BEGIN OF BLOCK BL1 WITH FRAME TITLE TEXT-T01.
  PARAMETERS : P_FILE TYPE RLGRAP-FILENAME OBLIGATORY DEFAULT 'C:\' MODIF ID ID1.
SELECTION-SCREEN END OF BLOCK BL1.
```

```abap
"엑셀 업로드
AT SELECTION-SCREEN ON VALUE-REQUEST FOR P_FILE.
  PERFORM GET_UPLOAD_FILE_NAME.
```

```abap
FORM GET_UPLOAD_FILE_NAME .
  CALL FUNCTION 'KD_GET_FILENAME_ON_F4'
    CHANGING
      FILE_NAME = P_FILE.
ENDFORM.                    " GET_UPLOAD_FILE_NAME
```


